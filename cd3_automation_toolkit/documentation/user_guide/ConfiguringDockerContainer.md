## Connect Docker container to OCI Tenancy

Once you are inside the container, follow the below steps to configure the docker container to connect to a tenancy:
> ***Same container can be connected to multiple OCI tenancies. Repeat this process for every new customer.***

**Step 1**:
<br>Change Directory to 'user-scripts'
<br>```cd /cd3user/oci_tools/cd3_automation_toolkit/user-scripts/```

**Step 2**:
<br> Create API PEM Key.
If the key pair does not exist, create them using the below command:
<br>```cd python createAPIKey.pys```

**Step 3**:
<br>Upload the Public key to **"APIkeys"** under user settings inOCI Console. Pre-requisite to use the complete functionality of the Automation Toolkit is to have the user as an administrator to the tenancy.
- Open the Console, and sign in as the user.
- View the details for the user who will be calling the API with the key pair.
- Open the Profile menu (User menu icon) and click User Settings.
- Click Add Public Key.</li><li>Paste the contents of the PEM public key in the dialog box and click Add.</li></ul>

**Step 4**:
<br>Enter the details to **tenancyconfig.properties** file 
```
[Default]
#Mandatory Fields
#Friendly name for the Customer Tenancy eg: gctenancy; The generated .auto.tfvars will be prefixed with this customer name
customer_name=
tenancy_ocid=
fingerprint=
user_ocid=
#Path of API Private Key (PEM Key) File; If the PEM keys were generated by running createAPI.py,leave this field empty.
#Defaults to /cd3user/tenancies/keys/oci_api_private.pem when left empty.
key_path=
#Region ; defaults to us-ashburn-1 when left empty.
region=
#Optional Fields
#SSH Key to launched instances
ssh_public_key=
```
| Initialise your environment to use the Automation Toolkit | <blockquote> **python createTenancyConfig.py tenancyconfig.properties** </blockquote>*Note - If the API Keys were generated and added to the OCI console using previous steps, it might take a couple of seconds to reflect. Thus, running the above command immediately might result in Authentication Errors.<br>In such cases, please retry after a minute.* |


**Files created on successfully completing the above steps - Description of the Generated files:**

| Files Generated | At File Path | Comment/Purpose |
| --------------- | ------------ | --------------- |
| Config File | ```/cd3user/tenancies/<customer_name>/<customer_name>_config``` | Customer specific Config file is required for OCI API calls. |
| setUpOCI.properties | ```/cd3user/tenancies/<customer_name>/<customer_name>_setUpOCI.properties``` | Customer Specific properties files will be created. |
| Region based directories | ```/rcd3user/tenancies/<customer_name>/terraform_files``` | Tenancy's subscribed regions based directories for the generation and segregation of terraform files. |
| Variables File,Provider File, Root and Sub modules | ```/cd3user/tenancies/<customer_name>/terraform_files/<region>``` | Required for terraform to work. |
| Public and Private Key Pair | Copied from ```/cd3user/tenancies/keys/```<br>to<br>```/cd3user/tenancies/<customer_name>/``` | API Keys that were previously generated are moved to customer specific out directory locations for easy access. |
| A log file with the commands to execute | ```/cd3user/tenancies/<customer_name>/cmds.log``` | This file contains a copy of the Commands to execute section of the console output. |
| Documentation folder | ```/cd3user/tenancies/<customer_name>/documentation/user_guide/```<br>```/cd3user/tenancies/<customer_name>/documentation/terraform/``` | These folders contain the .md files with instructions on how to use the toolkit and edit the .auto.tfvars. |
  
